<!DOCTYPE html>
<html>
<head>
  
  <!-- More triangles -->

  <title>My Personal Website</title>
  <style>
    html * {
        font-family: 'Roboto Medium';
    }

    .content {
        z-index: 1;
        width: 20vw;
        height: 16vh;
        float: right;
        border-radius: 3%;
        box-shadow: 0 0 0.2vw rgb(174, 82, 75);
        background-color: #c1928a;
        opacity: 93%;
    }

    .contact {
      display: flex;
    }

    .contact-item {
      width: 25%;
      margin-left: 5%;
      margin-right: 5%;
      box-shadow: 0 0 0.3vw black;
      border-radius: 10%;
      background-color: rgba(96, 75, 174, 0.568);
    }
    
    .name-text {
      text-align: center;
      font-size: 1.2vw;
    }

    .text-content::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        box-sizing: border-box;  
    }

    .triangle {
      top: 0;
      left: 0;
      border-left: 50px solid transparent;
      border-right: 50px solid transparent;
      
      position: absolute;
      z-index: -1;
    }

    #container {
      top: 2%;
      left: 2%;
      position: absolute;
      display: flex;
      flex-direction: column;
    }
    
    .rectangle {
      width: 100px;
      height: 100px;
      background: rgb(194, 190, 114);
      margin: 5px;
      z-index: 1;
      box-shadow: 0 0 5px black;
      text-align: center;
    }

    @keyframes move {
      50% {
        transform: translate(var(--dx), var(--dy));
      }
    }

    @keyframes fadeIn {
      0% {
        opacity: 0;
        scale: 0;
      }
      100% {
        opacity: 0.9;
        scale: 1;
      }
    }

    @keyframes fadeOut {
      100% {
        opacity: 0;
        scale: 0;
      }
    }

    .dir-title {
        text-align: center;
        height: 30%;
        width: 95%;
        margin-top: 5%;
        margin-left: 5%;
        margin-right: 5%;
        margin-bottom: 20%;
    }

    .dir-bttn {
      margin-top: 30%;
    }

    .animateIn {
      animation: fadeIn 1s;
      
      -webkit-animation: fadeIn 1s;
      -moz-animation: fadeIn 1s;
      -o-animation: fadeIn 1s;
    }

    .animateOut {
      animation: fadeOut 1s;
      
      -webkit-animation: fadeOut 1s;
      -moz-animation: fadeOut 1s;
      -o-animation: fadeOut 1s;
    }

    .grid {
      display: flex;
      position: absolute;
      top: 0;
      left: 0;
      transform: translate(4vw, 8vh);
    }

    .grid-item {
      background-color: #59a94a;
      z-index: 1;
      box-shadow: 0 0 0.5vh black;
      text-align: center;
    }
  </style>
</head>

<body>
    <div class="content">
      <h1 class="name-text">Yuval Shechter (Website WIP)</h1>
        <div class="contact">
          <img data-linkto="https://www.linkedin.com/in/yuval-shechter" class="contact-item" src="../images/linkedinlogo.png">
          <img data-linkto="https://github.com/shechteryuval/shechteryuval.github.io" class="contact-item" src="../images/githublogo.png">
          <img data-linkto="mailto:tmz0h32te@mozmail.com" class="contact-item" src="../images/outlooklogo.png">
        </div>
    </div>

  <!-- More triangle divs -->
  <script>
    function generateTriangle() {

        // Create triangle element
        const triangle = document.createElement('div');
        triangle.classList.add('triangle');

        const pageFrac = 1;

        // Random properties
        const x = Math.random() * pageFrac * 100;
        const y = Math.random() * pageFrac * 100;
        const x_end = Math.random() * pageFrac * 100;
        const y_end = Math.random() * pageFrac * 100;
        const dx = x_end - x;
        const dy = y_end - y;
        const opacity_based_rel_dist = Math.min(Math.pow(Math.pow(dx/100, 2) + Math.pow(dy/100, 2), 1.0/2.0), 0.8);
        const rotate = Math.random() * 360 + 120;
        const direction = Math.random() < 0.5 ? -1 : 1;

        triangle.style.left = `${x}vw`;
        triangle.style.top = `${y}vh`;

        // Set position and rotation
        triangle.style.transform = `rotate(${rotate}deg)`;

        triangle.style.borderBottom = `${"100px solid #" + Math.floor(Math.random()*16777215).toString(16)}`;
        triangle.style.opacity = `${opacity_based_rel_dist}`;

        triangle.style.setProperty('--dx', dx + 'vw');
        triangle.style.setProperty('--dy', dy + 'vh');

        // Set animation for movement
        triangle.style.animation = `move ${50*Math.random() + 30}s infinite linear`;

        // Append to body
        document.body.appendChild(triangle);
    }

    // Generate random triangles
    for (let i = 0; i < 50; i++) {
        generateTriangle();
    }

    const grid = document.createElement('div');
    grid.className = 'grid';
    document.body.appendChild(grid);

    const screenwidth = window.innerWidth;
    const screenheight = window.innerHeight;
    const ratio = screenheight/screenwidth;

    pagesdata = {
        "names": [
            "Writeups",
            "Creative",
            "Ideas"
        ],
        "linknames": [
          [
            "Finite Difference Function Calculator",
            "Periodic Activation Functions",
            "Recommender System Diversity",
            "Catastrophic Forgetting Mitigation",
            "Cauchy Residue Theorem"
          ],
        ],
        "linkthumbnails": [
          [
            "https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcglearn.eu%2Ffiles%2Fcourse%2F7%2FfiniteDifferences.png&f=1&nofb=1&ipt=02383c5af32024da43caa77cf36bbfea79801844d668791adc0cc66ff599d767&ipo=images",
            "https://d2vlcm61l7u1fs.cloudfront.net/media/efa/efa56b9c-b4c8-43ea-b501-d022caeef847/phps684tp.png", 
            "https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Flive.staticflickr.com%2F7884%2F45532583305_bedaed6296.jpg&f=1&nofb=1&ipt=d567b5540eb3e350dd026fc90de01a87aa6eed87252547e298729cb6b7075ccd&ipo=images", 
            "https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fwww.phase-6.com%2Fsystem%2Fgalleries%2Fpics%2FVokabeltrainer%2Fforgetting_curve_en.png&f=1&nofb=1&ipt=f53e8d77e1c7d8a45a1379c7d84167c166834e1a829ccd18b9f40d6ddb8b6977&ipo=images",
            "https://ekamperi.github.io/images/cauchy_complex_1.png"
          ],
        ],
        "link": [
            "./writeups.html"
        ]
    }

    const numRows = pagesdata["names"].length + 1;
    const numCols = pagesdata["linknames"].reduce((acc, e) => Math.max(acc, e.length), 0) + 1;
    const itemWidth =  ratio*Math.floor(92 / ((numCols-1) + 1));
    const itemHeight = Math.min((1/ratio)*itemWidth, Math.floor(92 / ((numRows-1) + 1)));
    
    grid.style.rowGap = `${Math.max(0.2 * (92 - (numRows-1)*itemHeight), 1)}vh`;
    grid.style.columnGap = `${0.5 * itemWidth}vw`;

    console.log(document.getElementsByClassName("contact-item"))

    Array.from(document.getElementsByClassName("contact-item")).forEach((item) => {
      item.addEventListener('mouseenter', (e) => {
        e.target.style.boxShadow = "0 0 1vh black";
        e.target.style.cursor = 'pointer';
      });

      item.addEventListener('mouseleave', (e) => {
        e.target.style.boxShadow = "0 0 0.5vh black";
        e.target.style.cursor = 'pointer';
      });

      item.addEventListener('click', (e) => {
        window.open(item.getAttribute("data-linkto"), "_blank");
      });
    });

    const gridItems = [];
    for (let i = 0; i < numRows; i++) {
      gridItems.push([]);
      for (let j = 0; j < numCols; j++) {
        const gridItem = document.createElement('div');
        
        gridItem.addEventListener('mouseenter', (e) => { 
          e.target.style.boxShadow = "0 0 1.5vh black";
          e.target.style.cursor = 'pointer';
        });
        gridItem.addEventListener('mouseleave', (e) => {
          e.target.style.boxShadow = "0 0 0.5vh black";
          e.target.style.cursor = 'default';
        });

        gridItem.className = 'grid-item';

        gridItem.style.height = `${itemHeight}vh`;
        gridItem.style.width = `${itemWidth}vw`;

        if (i || j) {
          gridItem.style.opacity = `0%`;
          gridItem.style.scale = 'scale(0)';
          if (i && !j) {
            const dirTxt = document.createElement('div');
            dirTxt.classList.add("dir-bttn");
            dirTxt.classList.add("dir-title");
            dirTxt.style.fontSize = `${Math.min(itemWidth, itemHeight)/5}${itemWidth < itemHeight ? "vw" : "vh"}`;
            dirTxt.textContent = pagesdata["names"][i - 1];
            gridItem.appendChild(dirTxt);
          } else if (i && j) {
            if (pagesdata["linknames"].length > (i-1)) {
              if (pagesdata["linknames"][i-1].length > (j-1)) {
                const gridImg = document.createElement('img');
                const gridTxt = document.createElement('div');
                gridTxt.style.fontSize = `${Math.min(itemWidth, itemHeight)/8}${itemWidth < itemHeight ? "vw" : "vh"}`;
                gridTxt.classList.add("dir-title");
                
                gridTxt.textContent = pagesdata["linknames"][i-1][j-1];
                gridImg.src = pagesdata["linkthumbnails"][i-1][j-1];

                gridItem.appendChild(gridTxt);
                gridItem.appendChild(gridImg);
                gridImg.style.height = "40%";
                gridImg.style.width = "90%";

                gridItem.addEventListener("click", (e) => {
                  window.location = pagesdata["link"][i-1];
                });
              }
            }
          }
        } else {
          gridItem.style.opacity = `80%`;
          gridItem.style.scale = 'scale(1)';
          const dirBttnTxt = document.createElement('div');
          dirBttnTxt.textContent = "Directory";
          dirBttnTxt.classList.add("dir-title");
          dirBttnTxt.classList.add("dir-bttn");
          dirBttnTxt.style.fontSize = `${Math.min(itemWidth, itemHeight)/5}${itemWidth < itemHeight ? "vw" : "vh"}`;
          gridItem.appendChild(dirBttnTxt);
        }

        grid.appendChild(gridItem); 
        gridItems[i].push(gridItem);
      }
    }

    gridItems.forEach((gridRow, i) => {
      gridRow.forEach((gridItem, j) => {
        if (i && !j) {
          const row = gridItems[i].slice(1);
          gridItem.addEventListener("click", (e) => {
            if (row.reduce((acc, elem) => acc && (elem.style.opacity == '0'), true)) {
              rowTransition(row, "show");
            } else {
              rowTransition(row, "hide");
            }
          });
        }
      })
    });

    gridItems[0][0].addEventListener("click", (e) => {
      if (gridItems.slice(1).reduce((acc, elem) => acc && (elem[0].style.opacity == '0'), true)) {
        directoryTransition(gridItems, "show");
      } else {
        directoryTransition(gridItems, "hide");
      }
    });

    // Grid styles
    grid.style.display = 'grid';
    grid.style.gridTemplate = `repeat(${numRows}, ${itemHeight}vh) / repeat(${numCols}, ${itemWidth}vw)`;

    function directoryTransition(pageGrid, opacityTransition) {
      if (opacityTransition == "show") {
        pageGrid.forEach((pages, i) => 
          pages.forEach((page, j) => {
            if (i && !j) {
              page.style.transition = `opacity 500ms ease-in-out, transform ${500 + 300*i + 200*j}ms`;
              page.style.opacity = `80%`;
              page.style.transform = 'scale(1)';
            }
        }));
      } else {
        pageGrid.forEach((pages, i) => 
          pages.forEach((page, j) => {
            if (i || j) {
              page.style.transition = `opacity 500ms ease-in-out, transform ${500 + 300*i + 200*j}ms`;
              page.style.opacity = `0%`;
              page.style.transform = 'scale(0)';
            }
        }));
      }
    }

    function rowTransition(row, opacityTransition) {
      if (opacityTransition == "show") {
        row.forEach((page, j) => {
          page.style.transition = `opacity 500ms ease-in-out, transform ${500 + 200*j}ms`;
          page.style.opacity = `80%`;
          page.style.transform = 'scale(1)';
        });
      } else {
        row.forEach((page, j) => {
          page.style.transition = `opacity 500ms ease-in-out, transform ${500 + 200*j}ms`;
          page.style.opacity = `0%`;
          page.style.transform = 'scale(0)';
        });
      }
    }
  </script>
</body>
</html>